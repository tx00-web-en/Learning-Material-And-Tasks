# Activity 1: Introduction to API Documentation with Swagger/OpenAPI

## Objective:
The objective of this lab is to familiarize with API documentation using Swagger/OpenAPI. In this lab, you will be working with simple RESTful API provided by JSONPlaceholder to perform CRUD (Create, Read, Update, Delete) operations.

## Part 1/3 : JSONPlaceholder todos API

> This is one way of generating documentation. For more check this [summary](./be-summary.md)

1. Explore the API:
   - Open the following URL in your browser to explore the API: [https://jsonplaceholder.typicode.com/todos](https://jsonplaceholder.typicode.com/todos)
   - Take note of the structure of the data and available endpoints.

2. Generate Swagger/OpenAPI Documentation:
   - Use `ChatGPT` to generate a Swagger/OpenAPI JSON document for the API. You can use the following prompt: *Generate a Swagger/OpenAPI JSON document for the API at this endpoint: `https://jsonplaceholder.typicode.com/todos`.*
   - Copy the generated JSON document.

3. Open Swagger Editor:
   - Visit [Swagger Editor](https://editor.swagger.io/) in your web browser.

4. Paste JSON into Swagger Editor:
   - Paste the copied JSON document into the Swagger Editor.

5. Convert to YAML (Optional):
   - When prompted to convert the JSON to YAML, click **Cancel**. For this part, we will stick with the JSON format.

6. Explore API Documentation:
   - Examine the Swagger Editor interface to understand the structure of the API documentation.
   - Navigate through the various sections such as "Paths," "Operations," and "Responses."

7. Test Endpoints:
   - For each endpoint (GET, POST, PUT, DELETE), use Swagger Editor to test the operations:
     - **GET /todos:** Retrieve a list of todos.
     - **POST /todos:** Create a new todo.
     - **GET /todos/{todoId}:** Retrieve information about a specific todo.
     - **PUT /todos/{todoId}:** Update information for a specific todo.
     - **DELETE /todos/{todoId}:** Delete a specific todo.

8. Observe Responses:
   - Pay attention to the responses generated by the API for each operation.
   - Understand the structure of a successful response and error responses.

**Explanation**

1. "servers" Section:

```json
"servers": [
    {
      "url": "https://jsonplaceholder.typicode.com"
    }
]
```

This section is used to define the base URL(s) for the API. In this case, there is one server specified with the URL "https://jsonplaceholder.typicode.com". This base URL is prepended to all the paths defined in the API. It indicates the root URL where the API is hosted.

2. "paths" Section:

```json
"paths": {
    "/comments": {
        // ... (other properties for the /comments path)
    }
}
```

The "paths" section is where you define the available paths or endpoints in your API along with the supported operations (GET, POST, PUT, DELETE, etc.). In this snippet, there's an example path "/comments" that likely represents the comments resource.

3. "components" Section:

```json
"components": {
    "schemas": {
        "NewComment": {
            // ... (definition for the NewComment schema)
        }
    }
}
```

The "components" section is used to define reusable components for the API. In this case, it's specifying a "schemas" subsection, which allows you to define data structures or models that can be used elsewhere in the API.

```json
"NewComment": {
    // ... (definition for the NewComment schema)
}
```

Inside "schemas," there's a definition for a schema named "NewComment." This  represents the structure of a new comment that can be used when creating a comment through a POST request.


## Part 2/3

Follow the steps of part 1 to generate documentation for the following APIs:
- https://jsonplaceholder.typicode.com/photos
- https://jsonplaceholder.typicode.com/todos
- https://jsonplaceholder.typicode.com/users

## Part 3/3:

> This is another way of generating documentation. For more check the [summary](./be-summary.md)
> This activity is **optional**

Create documentation for the workout (V1) API server. You can clone the server's source code [from here](https://github.com/tx00-resources-en/week7-be-workout-v1-starter)

To get started, follow these steps:

1. Begin by installing the following packages: `swagger-ui-express` and `swagger-jsdoc`:

```sh
npm install swagger-ui-express swagger-jsdoc
```

2. Create a file named `swaggerConfig.js` with the following content:

```js
const swaggerJsdoc = require("swagger-jsdoc");

const options = {
  definition: {
    openapi: "3.0.0",
    info: {
      title: "Workout API",
      version: "1.0.0",
      description: "API for managing workouts",
    },
    servers: [
      {
        url: "http://localhost:4000/api", // Update with your API server URL
      },
    ],
  },
  apis: ["routes/*.js"], // Update with the path to your route file
  components: {
    schemas: {
      Workout: {
        type: "object",
        properties: {
          title: { type: "string" },
          reps: { type: "number" },
          load: { type: "number" },
        },
        example: {
          title: "Sample Workout",
          reps: 10,
          load: 50,
        },
      },
    },
  },
};

const specs = swaggerJsdoc(options);
module.exports = specs;
```

3. At the top of your app.js file, add the following code:
   
```javascript
// Import your Swagger configuration
const swaggerUi = require("swagger-ui-express");
const swaggerSpec = require("./swaggerConfig.js");
```

4. In app.js, modify your routes as follows:

```javascript
// routes
app.use("/api/workouts", workoutRoutes);
app.use("/api-docs", swaggerUi.serve, swaggerUi.setup(swaggerSpec));
```

5. You can use your preferred LLM to generate annotations for the router. Use the following prompt: *Annotate this API's router using 'swagger-jsdoc'*. Provide the *code* for the **router**, **controller**, and **model**. The LLM will return the annotated code. Replace the contents of `routes/workouts.js` with the generated code e.g. 

  
```js
const express = require("express");
const {
  getWorkouts,
  getWorkout,
  createWorkout,
  deleteWorkout,
  updateWorkout,
} = require("../controllers/workoutController");

const router = express.Router();

/**
 * @swagger
 * tags:
 *   name: Workouts
 *   description: API endpoints for managing workouts
 */

/**
 * @swagger
 * components:
 *   schemas:
 *     Workout:
 *       type: object
 *       properties:
 *         title:
 *           type: string
 *         reps:
 *           type: integer
 *         load:
 *           type: integer
 *       required:
 *         - title
 *         - reps
 *         - load
 *       example:
 *         title: Push ups
 *         reps: 40
 *         load: 5
 */

// GET all workouts
/**
 * @swagger
 * /workouts:
 *   get:
 *     summary: Get all workouts
 *     tags: [Workouts]
 *     responses:
 *       200:
 *         description: Returns an array of all workouts
 *       500:
 *         description: Internal server error
 */
router.get("/", getWorkouts);

// GET a single workout
/**
 * @swagger
 * /workouts/{id}:
 *   get:
 *     summary: Get a single workout by ID
 *     tags: [Workouts]
 *     parameters:
 *       - in: path
 *         name: id
 *         required: true
 *         description: ID of the workout to retrieve
 *         schema:
 *           type: string
 *     responses:
 *       200:
 *         description: Returns a single workout
 *       404:
 *         description: Workout not found
 *       500:
 *         description: Internal server error
 */
router.get("/:id", getWorkout);

// POST a new workout
/**
 * @swagger
 * /workouts:
 *   post:
 *     summary: Create a new workout
 *     tags: [Workouts]
 *     requestBody:
 *       description: New workout object
 *       required: true
 *       content:
 *         application/json:
 *           schema:
 *             $ref: '#/components/schemas/Workout'
 *     responses:
 *       201:
 *         description: Workout created successfully
 *       400:
 *         description: Bad request
 *       500:
 *         description: Internal server error
 */
router.post("/", createWorkout);

// DELETE a workout
/**
 * @swagger
 * /workouts/{id}:
 *   delete:
 *     summary: Delete a workout by ID
 *     tags: [Workouts]
 *     parameters:
 *       - in: path
 *         name: id
 *         required: true
 *         description: ID of the workout to delete
 *         schema:
 *           type: string
 *     responses:
 *       204:
 *         description: Workout deleted successfully
 *       404:
 *         description: Workout not found
 *       500:
 *         description: Internal server error
 */
router.delete("/:id", deleteWorkout);

// UPDATE a workout
/**
 * @swagger
 * /workouts/{id}:
 *   patch:
 *     summary: Update a workout by ID
 *     tags: [Workouts]
 *     parameters:
 *       - in: path
 *         name: id
 *         required: true
 *         description: ID of the workout to update
 *         schema:
 *           type: string
 *     requestBody:
 *       description: Updated workout object
 *       required: true
 *       content:
 *         application/json:
 *           schema:
 *             $ref: '#/components/schemas/Workout'
 *     responses:
 *       200:
 *         description: Workout updated successfully
 *       404:
 *         description: Workout not found
 *       500:
 *         description: Internal server error
 */
router.patch("/:id", updateWorkout);

module.exports = router;
```
6. Start the server.

7. Visit http://localhost:4000/api-docs to access and test all the API endpoints.



> The final code is [here](https://github.com/tx00-resources-en/week7-be-workout-v1-doc)